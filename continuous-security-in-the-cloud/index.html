<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Continuous Security in the Cloud</title>
  <meta name="description" content="Continuous Security in the Cloud">
  <meta name="author" content="Stein Inge Morisbak">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="../css/reveal.min.css">
  <link rel="stylesheet" href="../lib/css/zenburn.css">
  <link rel="stylesheet" href="../css/theme/bekk.css" id="theme">
  <link rel="stylesheet" href="css/custom.css" id="custom">
  <script>
    document.write('<link rel="stylesheet" href="../css/print/' + (window.location.search.match(/print-pdf/gi) ? 'pdf' : 'paper') + '.css" type="text/css" media="print">');

  </script>
</head>

<body>
  <div class="reveal">
    <div class="slides">

      <section data-background-video="../video/bedopress_animasjon_highress.mp4" data-background-video-loop="true" data-background="rgb(23, 22, 23)">
      </section>

      <section data-background-video="../video/bedopress_animasjon_highress.mp4" data-background-video-loop="true" data-background="rgb(23, 22, 23)">
        <h1>Continuous Security in the Cloud</h1>
        <p>JavaZone 2017</p>
        <img width="252" height="235" src="../img/me_bart.png" alt="Stein Inge Morisbak">
        <p style="font-size: 28px;"><a href="https://twitter.com/steinim">@steinim</a></p>
        <p style="font-size: 28px;"><a href="mailto:stein.inge.morisbak@BEKK.no">stein.inge.morisbak@BEKK.no</a></p>
        <aside class="notes">
        </aside>
      </section>


      <section>
        <h1>&nbsp;</h1>
        <img width="235" height="235" src="img/nsb.png" alt="NSB">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
          <ul>
            <li>Det siste halve året har BEKK-teamet hos NSB jobbet med å migrere tjenester fra intern infrastruktur til AWS.</li>
            <li>Vi har også etablert et par nye tjenester</li>
            <li>Enkelhet og automatisering har vært de viktigste prinsippene vi har styrt etter</li>
            <li>– uten at det skal gå ut over tilgjengelighet, stabilitet, og ikke minst sikkerhet</li>
            <li>Jeg vil i dette foredraget skryte av og vise frem hva vi har tatt i bruk av praksiser, tjenester og verktøy som understøtter en taktfast og rask flyt av verdifull programvare til produksjon på en trygg og sikker måte.</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>&nbsp;</h1>
        <img width="235" height="235" src="img/aws.jpg" alt="AWS">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">Vi skal se på hvilke skytjenester vi har tatt i bruk i AWS.</aside>
      </section>

      <section data-background-image="img/move_to_cloud.jpg">
      </section>

      <section>
        <h1>Why?</h1>
        <img height="435" src="img/it-factory.png" alt="IT factory">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">Alle virksomheter er IT-virksomheter</aside>
      </section>

      <section>
        <h1>Why now?</h1>
        <div class="mb-wrap mb-style-3">
          <div class="mb-thumb-gene-kim"></div>
          <blockquote>
            <p>Those not transforming their IT
              <br>organizations risk being left behind, missing
              <br>out on one of the most disruptive and
              <br>innovative periods in technology.</p>
          </blockquote>
          <div class="mb-attribution">
            <p class="mb-author">Gene Kim</p>
            <cite><a href="http://blogs.wsj.com/cio/2014/05/22/enterprise-devops-adoption-isnt-mandatory-but-neither-is-survival/">The Wall Street Journal, CIO Journal, May 22nd, 2014</a></cite>
          </div>
        </div>
        <aside class="notes">
          <ul>
            <li>If you want to compete in a market where more and more businesses are adopting these changes and you don't adopt these new ways of getting work done you are really missing out.</li>
            <li>It is happening now and can not be stopped.</li>
            <li>And it is not just for startups. The large enterprises and the public sector also have to take this seriously to not be left behind.</li>
            <li>The advantages overshadow traditional requirements for security work.</li>
            <li>Change is inevitable.</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>A shift in focus</h1>
        <p>&nbsp;</p>
        <table class="reveal" width="100%">
          <tr>
            <td width="45%" align="right">
              <p>Development</p>
              <p>Operations</p>
              <p>Maintenance</p>
            </td>
            <td width="10%" align="center">
              <p>&#8664;</p>
              <p>&rArr;</p>
              <p>&#8663;</p>
            </td>
            <td width="45%" align="left">
              <p>&nbsp;</p>
              <p><b>Product development</b></p>
              <p>&nbsp;</p>
            </td>
          </tr>
        </table>
        <h1>&nbsp;</h1>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Competitive advantage</h1>
        <ul>
          <li class="fragment">Innovate more</li>
          <li class="fragment">Experiment more</li>
          <li class="fragment">Faster time to market</li>
          <li class="fragment">Build &rarr; Measure &rarr; Learn &rarr; Repeat <b>&#8634;</b></li>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>How?</h2>
        <h1 class="fragment">Continuous Delivery</h1>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>What is Continuous Delivery?</h1>
        <img src="img/continuous_delivery.jpg" style="float: left;" width="25%">
        <blockquote cite="https://martinfowler.com/bliki/ContinuousDelivery.html" style="float: right;">
          ...a software development discipline where you build software in such a way that the software can be released to production at any time.
          <br>
        </blockquote>
        <footer style="float: right; font-size: 0.5em;">
          <a href="https://martinfowler.com/bliki/ContinuousDelivery.html"></a>Martin Fowler, https://martinfowler.com/bliki/ContinuousDelivery.html</footer>
        <blockquote cite="https://continuousdelivery.com/2010/08/continuous-delivery-vs-continuous-deployment/" style="float: right;">
          Continuous delivery is about putting the release schedule in the hands of the business,<br>not in the hands of IT.
        </blockquote>
        <footer style="float: right; font-size: 0.5em;">
          <a href="https://continuousdelivery.com/"></a>Jez Humble, https://continuousdelivery.com/</footer>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Continuous Delivery &hearts; DevOps</h1>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>What is DevOps?</h1>
        <aside class="notes">
        </aside>
      </section>

      <!--<section style="background-image: url(img/devops.png); background-position: 50% 50% ; background-size: 35%; background-repeat: no-repeat;">-->
      <section style="width: 100%; height: 100%;">
        <h1>Definition #1</h1>
        <div class="mb-wrap mb-style-3">
          <div class="mb-thumb-barton-george"></div>
          <blockquote>
            <p>…it is getting developers and operations folk to work closely<br>together to benefit the business.</p>
          </blockquote>
          <div class="mb-attribution">
            <p class="mb-author">Barton George</p>
            <cite><a href="https://venturebeat.com/2013/09/30/an-idiots-guide-to-devops/">An idiot’s guide to DevOps, Sept 30th, 2013</a></cite>
          </div>
        </div>
        <img src="img/devops.png" style="float: left; background:none; border:none; box-shadow:none; position: absolute; top: 52%; left: -10%;">
        <footer class="layer right">Image by <a href="https://www.flickr.com/photos/87777282@N00/">newwavegurly</a> licensed by <a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">CC BY-NC-ND 2.0</a></footer>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>But we have no Ops!</h1>
        <img width="235" height="235" src="img/noops.png" alt="NoOps">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>NoOps != No Operations</h1>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Definition #2</h1>
        <div class="mb-wrap mb-style-3">
          <blockquote>
            <p>Developers carry beepers.</p>
          </blockquote>
          <div class="mb-attribution">
            <p class="mb-author">Kent Beck</p>
            <cite><a href="https://www.meetup.com/DevOps-Norway/events/112627352/">At a DevOps Norway Meetup in 2013</a></cite>
          </div>
        </div>
        <img src="img/kent_beck.png" style="float: left; background:none; border:none; box-shadow:none; position: absolute; top: 80%; left: -10%;">
        <aside class="notes">
          * Kent Beck once gave me his definition of DevOps, "Developers carry beepers". * And he is absolutely right. It must be the ones that develop the systems that must watch over them. * They understand the systems a lot better than anyone else, they understand the risks, and they are better off fixing problems when they occur. * It also creates incentives to build things that don't break.
        </aside>
      </section>

      <section data-background-image="img/werner_vogels.jpg" style="width: 100%; height: 100%;">
        <div class="mb-wrap mb-style-3" style="position: relative; left: 27%;">
          <blockquote style="background: rgba(0, 0, 0, 0.65);">
            <p>You build it, you run it!</p>
          </blockquote>
          <div class="mb-attribution">
            <p class="mb-author">Werner Vogels (CTO Amazon)</p>
            <cite style="background: rgba(0, 0, 0, 0.65);"><a href="https://queue.acm.org/detail.cfm?id=1142065">A Conversation with Werner Vogels, Queue, June 30th, 2006</a></cite>
          </div>
        </div>
        <footer class="layer right">Image by <a href="https://www.flickr.com/photos/vannispen/">Guido van Nispen</a> licensed by <a href="http://creativecommons.org/licenses/by-sa/2.0">CC BY-SA 2.0</a></footer>
        <aside class="notes">
          <p>If you use the line to create products or services instead you can let the team take responsibility from day one.</p>
          <p>You push maintenance and operations to the very start of the development.</p>
          <p>They who create the software must be responsible from conception to when the software dies.</p>
        </aside>
      </section>

      <section>
        <h1>Definition #3</h1>
        <div class="mb-wrap mb-style-3">
          <div class="mb-thumb-gene-kim"></div>
          <blockquote>
            …the practices that enable fast flow of features into production, while preserving world-class availability, stability, security, etc.
          </blockquote>
          <div class="mb-attribution">
            <p class="mb-author">Gene Kim</p>
            <cite><a href="https://books.google.no/books?id=_An-CAAAQBAJ&pg=PA350&lpg=PA350&dq=the+practices+that+enable+fast+flow+of+features+into+production,+while+preserving+world-class+availability,+stability,+security">Gene Kim, Kevin Behr, George Spafford, The Phoenix Project. Page 350, 2013</a></cite>
          </div>
        </div>
        <aside class="notes">
          <ul>
            <li>If you want to compete in a market where more and more businesses are adopting these changes and you don't adopt these new ways of getting work done you are really missing out.</li>
            <li>It is happening now and can not be stopped.</li>
            <li>And it is not just for startups. The large enterprises and the public sector also have to take this seriously to not be left behind.</li>
            <li>The advantages overshadow traditional requirements for security work.</li>
            <li>Change is inevitable.</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>DevOps &hearts; Cloud</h1>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Cloud reduces ops complexity</h1>
        <aside class="notes">
        </aside>
      </section>

      <section style="width: 100%; height: 100%;">

        <footer class="left" style="position: absolute; top: 30%;">
          <div style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178); float:left;">&nbsp;&nbsp;&nbsp;</div>
          <div style="float:left;">&nbsp;You manage</div><br><br>
          <div style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5); float:left;">&nbsp;&nbsp;&nbsp;</div>
          <div style="float:left;">&nbsp;Vendor managed</div>
        </footer>

        <h1>Let the cloud vendor cover your *aaS</h1>

        <ul class="fragment" data-fragment-index="1" style="zoom:1; *display: inline; _height: 30px; list-style-type: none;">
          <h3>On premises</h3>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Applications</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Data</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Runtime</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Middleware</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Virtualization</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Servers</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Networking</li>
        </ul>
        <ul class="fragment" data-fragment-index="2" style="zoom:1; *display: inline; _height: 30px; list-style-type: none;">
          <h3>IaaS</h3>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Applications</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Data</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Runtime</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Middleware</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Virtualization</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Servers</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Networking</li>
        </ul>
        <ul class="fragment" data-fragment-index="3" style="zoom:1; *display: inline; _height: 30px; list-style-type: none;">
          <h3>PaaS</h3>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Applications</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgb(53, 189, 178);">&nbsp;Data</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Runtime</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Middleware</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Virtualization</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Servers</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Networking</li>
        </ul>
        <ul class="fragment" data-fragment-index="4" style="zoom:1; *display: inline; _height: 30px; list-style-type: none;">
          <h3>SaaS</h3>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Applications</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Data</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Runtime</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Middleware</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Virtualization</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Servers</li>
          <li style="box-shadow: -5px 4px 25px rgba(255, 255, 255, 0.5); background: rgba(53, 189, 178, 0.5);">&nbsp;Networking</li>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Principles for harnessing the cloud</h1>
        <ul>
          <li class="fragment">Iaas &rarr; PaaS and SaaS</li>
          <li class="fragment">Automate against APIs<br> (no clicking in GUI and fiddling in prod)</li>
          <li class="fragment">Buy/use services instead of rolling your own</li>
          <li class="fragment">Use <b>public</b> cloud, not private!</li>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Our most important principles</h1>
        <blockquote class="fragment">Simplicity and automation</blockquote>
        <blockquote class="fragment">while preserving world class <br>availability, stability and security</blockquote>
      </section>

      <section>
        <h1>Our sollution</h1>
        <ul>
          <li class="fragment">Crossfunctional teams including business
            <br>(Build &rarr; Measure &rarr; Learn)</li>
          <li class="fragment">Dev(Ops) and Continuous Delivery</li>
          <li class="fragment">You build it, you run it</li>
          <li class="fragment">Cloud, Cloud, Cloud!</li>
        </ul>
      </section>


      <section>
        <h1>The juicy part</h1>
      </section>

      <section>
        <h1>Source code</h1>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
./infrastructure
./app-infrastructure
./app1
./app2
./appN
...
     </code></pre>
        <aside class="notes">Repoene er grovt delt inn i tre.</aside>
      </section>

      <section>
        <h2><code>./infrastructure</code> (IaaS)</h2>
        <ul>
          <li class="fragment">Nettverk</li>
          <li class="fragment">Bastion host</li>
          <li class="fragment">Andre egendefinerte instanser:</li>
          <ul>
            <li class="fragment">mgmtserver</li>
            <li class="fragment">ElasticSearch/Kibana (<b>SaaS</b>)</li>
            <li class="fragment">ElasticSearch reverse proxy</li>
          </ul>
        </ul>
        <aside class="notes">
          <ul>
            <li>I infrastruktur-repoet har du oppsett av basis infrastruktur</li>
            <ul>
              <li>Nettverk</li>
              <li>Bastion host (jump server for å få tilgang til alt inne i bobla av tjenester)</li>
            </ul>
            <li>Andre ting som går på tvers:</li>
            <ul>
              <li>En server for å gjøre oppgaver internt i det private subnettet.</li>
              <li>Bør ikke være det samme som bastion-host da denne bør være "hardnet" og kun være en ssh proxy</li>
              <li>Oppgaver som backup og cron-jobber (kun brukt for en php-app)</li>
              <li>ElasticSearch cluster for å samle inn logger fra alle mulige steder (SaaS)</li>
              <li>Reverse proxy for å legge på et lag med sikkerhet foran Kibana</li>
            </ul>
          </ul>
        </aside>
      </section>

      <section>
        <h1>The right tool for the job?</h1>
        <img width="235" height="235" class="fragment" src="img/terraform.png" alt="Terraform">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
          <ul>
            <li>Terraform er et verktøy for å lage, endre og versjonere infrastruktur på en trygg automatisert og effektiv måte.</li>
            <li>Du beskriver infrastrukturen din i konfigurasjonsfiler og så generer du en eksekveringsplan som beskriver hva Terraform vil gjøre for å nå den ønskede tilstanden</li>
            <li>Når du gjør endringer finner Terraform ut av hva som er endringen og eksekverer kun endringen inkrementelt.</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>What does it do?</h1>
        <ul>
          <li class="fragment">Documents (infrastructure as code)</li>
          <li class="fragment">Plans (no surprises)</li>
          <li class="fragment">Graphs (parallelizes where possible)</li>
          <li class="fragment">Automates (takes the human out of the equation)</li>
        </ul>
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
          <ul>
            <li>Infrastructure as code: dokumentasjon, deling og gjenbruk</li>
            <li>Execution plans: Viser i detalj hva som skal eksekveres. Unngå overaskelser</li>
            <li>Resource graph: paralleliserer der den kan og respekterer avhengigheter</li>
            <li>Automation: Automatiserer alt</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1><code>./infrastructure</code> (IaaS)</h1>
        <aside class="notes">
          <ul>
            <li>I infrastruktur-repoet har du oppsett av basis infrastruktur</li>
            <ul>
              <li>Nettverk</li>
              <li>Bastion host (jump server for å få tilgang til alt inne i bobla av tjenester)</li>
            </ul>
            <li>Andre ting som går på tvers:</li>
            <ul>
              <li>En server for å gjøre oppgaver internt i det private subnettet.</li>
              <li>Bør ikke være det samme som bastion-host da denne bør være "hardnet" og kun være en ssh proxy</li>
              <li>Oppgaver som backup og cron-jobber (kun brukt for en php-app)</li>
              <li>ElasticSearch cluster for å samle inn logger fra alle mulige steder (SaaS)</li>
              <li>Reverse proxy for å legge på et lag med sikkerhet foran Kibana</li>
            </ul>
          </ul>
        </aside>
      </section>

      <!-- Layout -->
      <section>
        <h2>Layout</h2>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
./infrastructure
├── &lt;environment&gt;
│   ├── main.tf
│   └── vars.tf
├── modules
│   ├── &lt;module name&gt;
│   │   ├── main.tf
│   │   └── vars.tf
│   │   ├── outputs.tf
     </code></pre>
        <aside class="notes"></aside>
      </section>

      <section>
        <h1>Nettverk</h1>
        <img height="235" src="img/network.png" alt="Nettverk">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">Og så skal vi se på en rekke verktøy vi bruker for å automatisere, forenkle og sikre infrastruktur og applikasjoner.</aside>
      </section>

      <section>
        <img src="img/vpc.png" alt="VPC">
        <aside class="notes">
          <ul>
            <li>VPC</li>
          </ul>
        </aside>
      </section>

      <!-- VPC -->
      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">

provider "aws" {
  region = "${var.aws_region}"
}

resource "aws_vpc" "vpc" {
    cidr_block           = "${var.vpc_cidr}"
    enable_dns_hostnames = true
    tags { Name = "${var.vpc_name}" }
}

resource "aws_internet_gateway" "ig" {
    vpc_id = "${aws_vpc.vpc.id}"
    tags { Name = "${var.ig_name}" }
}

# Grant the VPC internet access on its main route table
resource "aws_route" "internet_access_route" {
  route_table_id         = "${aws_vpc.vpc.main_route_table_id}"
  destination_cidr_block = "0.0.0.0/0"
  gateway_id             = "${aws_internet_gateway.ig.id}"
}
     </code></pre>
        <aside class="notes"></aside>
      </section>

      <section>
        <img src="img/availability-zones.png" alt="Availability Zones">
        <aside class="notes">
          <ul>
            <li>Availability Zones</li>
          </ul>
        </aside>
      </section>

      <section>
        <img src="img/subnets.png" alt="Subnets">
        <aside class="notes">
          <ul>
            <li>Subnets</li>
          </ul>
        </aside>
      </section>

      <!-- Subnets og Availability Zones -->
      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
resource "aws_subnet" "subnet" {
  vpc_id                  = "${var.vpc_id}"
  count                   = "${var.number_of_subnets}"
  cidr_block              = "${lookup(var.cidr_blocks, "zone_${count.index}")}"
  availability_zone       = "${lookup(var.zones, "zone_${count.index}")}"
  map_public_ip_on_launch = "${var.map_public_ip_on_launch}"

  tags { Name = "${var.name}_subnet_${lookup(var.zones, "zone_${count.index}")}" }
}
     </code></pre>
        <aside class="notes">
          Counters and variables
        </aside>
      </section>

      <section>
        <img src="img/db_subnet_group.png" alt="DB Subnet Group">
        <aside class="notes">
          <ul>
            <li>Subnets</li>
          </ul>
        </aside>
      </section>

      <!-- Bastion, Mgmtserver, Elasticsearch proxy -->
      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
resource "aws_instance" "instance" {
  ami                         = "${var.ami}"
  instance_type               = "t2.micro"
  key_name                    = "${var.key_pair_id}"
  subnet_id                   = "${var.subnet_id}"
  associate_public_ip_address = true
  source_dest_check           = false
  vpc_security_group_ids = [ "${var.security_group_ids} ]
  tags { Name = "${var.instance_name}" }
}
     </code></pre>
        <aside class="notes">
          Bastion host and mgmtserver
        </aside>
      </section>

      <section>
        <img src="img/instances.png" alt="Subnets">
        <aside class="notes">
          <ul>
            <li>Subnets</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>Tools</h1>
        <img width="235" height="235" src="img/toolbox.png" alt="Verktøykasse">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">Og så skal vi se på en rekke verktøy vi bruker for å automatisere, forenkle og sikre infrastruktur og applikasjoner.</aside>
      </section>

      <section>
        <h1>Hemmeligheter og andre variabler</h1>
        <img width="235" height="235" src="img/padlock.png" alt="Padlock">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
          <ul>
            <li>I det forrige eksemplet så dere noen hemmeligheter som variabler</li>
            <li>For å automatisere innsetting av hemmeligheter har vi satt sammen en pakke</li>
          </ul>
        </aside>
      </section>

      <section>
        <img src="img/terraform-wrapper.png" alt="terraform-wrapper">
        <aside class="notes">Digipost har utviklet og open sourcet en wrapper rundt Terraform</aside>
      </section>

      <section>
        <img src="img/terragrunt-wrapper.png" alt="terragrunt-wrapper">
        <aside class="notes">
          <ul>
            <li>NSB har rappet og videreutviklet sin egen wrapper</li>
            <li>Det er en terragrunt-wrapper som er en wrapper rundt terragrunt som er en wrapper rundt terraform</li>
            <li>Mer om terragrunt senere.</li>
          </ul>
        </aside>
      </section>

      <section>
        <h2><code>cloud-config.yml</code></h2>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
vars:
  - name: AWS_DEFAULT_REGION
    value: eu-central-1
  - name: TF_VAR_env
    value: opstest
  - name: TF_VAR_public_key
    value: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzwGCC+nMTL6QIg+Z7SXtIXhiJJ5caa5tZkWQ1E6jDgHp7NqDAb21ZzjK3mGFlugF81h3OBF8uZPE5E+A0mRCB/pMzEMi/SBv0nvuPhijT81OeJxiF11Zxejc6gk8YiJIywQcYD3OcmmWvP2gK7MU1VIf3SQjHEROMaz+4uNJlC6QpDJfepxevQVJ4GVk7uq71NJjXV91gyT4/smOz5dP6tT7dYuP5Zn3lr5VN/BmHmtpklK9AWhwoIyRi+t97T1ihgiDvrmg7QSH9hIM+zKH2oxWi0RGV99t+ac6DV54ys4XD7OLAhHdlL7qV2G1TSIFqXXOaV98Cj2Mkxd2vJhhZ"

commands:
  - executable: "../bin/get-aws-ids.sh"
    arguments: ["cloud.nsb.no"]
    outputfile: "dynamic-variables.tf"

secret-vars:
  - name: TF_VAR_elasticsearch_proxy_admin_password
    key:  nsb/aws/elasticsearch_proxy/opstest/admin_password
     </code></pre>
        <aside class="notes">
          <ul>
            <li>Starte med vars. Hvorfor begynner de med TF_VAR?</li>
            <li>Commands. Lager dynamiske variabler. I dette tilfellet hentes variabler ut med aws_cli</li>
            <li>Secret vars (fra digipost) bruker passwordstore, kommandolinje-verktøy for kryptering av hemmeligheter</li>
          </ul>
        </aside>
      </section>

      <section>
        <img src="img/pass.png" alt="passwordstore">
        <aside class="notes">
          <ul>
            <li>.</li>
          </ul>
        </aside>
      </section>

      <section>
        <h2><code>pass</code></h2>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
~/src/nsb/.password-store
├── nsb
│   ├── aws
│   │   ├── elasticsearch_proxy
│   │   │   ├── prod
│   │   │   │   └── admin_password.gpg
│   │   │   ├── opstest
│   │   │   │   └── admin_password.gpg
│   │   ├── nsb.pem.gpg
│   ├── maven
│   │   └── settings.xml.gpg
│   └── travis
│       └── nsbno-buildserver.gpg
├── panopticon
│   └── aws
│       ├── prod
│       │   └── vault_password.gpg
│       └── opstest
│           └── vault_password.gpg
     </code></pre>
        <aside class="notes">
          <ul>
            <li>Kjør pass</li>
          </ul>
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
✗ pass show -c bekk/aws/root/password
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px; ">

┌────────────────────────────────────────────────────────────────────────────────────┐
│ Please enter the passphrase to unlock the secret key for the OpenPGP certificate:  │
│ "Stein Inge Morisbak &lt;stein.inge.morisbak@BEKK.no&gt;"                                │
│ 2048-bit RSA key, ID 38380D80,                                                     │
│ created 2014-05-15 (main key ID 0CB573BF).                                         │
│                                                                                    │
│                                                                                    │
│ Passphrase ***********____________________________________________________________ │
│                                                                                    │
│            &lt;OK&gt;                                                  &lt;Cancel&gt;          │
└────────────────────────────────────────────────────────────────────────────────────┘
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
✗ pass show -c bekk/aws/root/password
Copied bekk/aws/root/password to clipboard. Will clear in 45 seconds.
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <img src="img/envchain.png" alt="envchain">
        <aside class="notes">
          <ul>
            <li></li>
          </ul>
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
✗ envchain --set aws AWS_ACCESS_KEY_ID AWS_SECRET_ACCESS_KEY
aws.AWS_ACCESS_KEY_ID: AKIAXXXXXXXXXXXXXXXX
aws.AWS_SECRET_ACCESS_KEY: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
     </code></pre>

        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
✗ envchain aws env | grep AWS_
AWS_ACCESS_KEY_ID=AKIAXXXXXXXXXXXXXXXX
AWS_SECRET_ACCESS_KEY=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
✗ envchain aws terragrunt-wrapper apply
     </code></pre>
        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px; max-height: 1000px;">
Started terragrunt operation at: 2017-03-02 16:12:40.505382704 +0100 CET
[terragrunt] 2017/03/02 16:12:41 Reading Terragrunt config file at /Users/steiningemorisbak/src/nsb/infrastructure/opstest/.terragrunt
[terragrunt] 2017/03/02 16:12:41 Remote state is already configured for backend s3
[terragrunt] 2017/03/02 16:12:41 Attempting to acquire lock for state file infrastructure-test1 in DynamoDB
[terragrunt] 2017/03/02 16:12:41 Attempting to create lock item for state file infrastructure-test1 in DynamoDB table terragrunt_locks
[terragrunt] 2017/03/02 16:12:42 Lock acquired!
[terragrunt] 2017/03/02 16:12:42 Running command: terraform apply
     </code></pre>

        <aside class="notes">
          <strong>NB! neste er terminalvideo!</strong>
        </aside>
      </section>

      <section data-background-video="movie/terragrunt-infrastructure-plan.mp4" data-background="#000000">
      </section>

      <section data-background-video="movie/terragrunt-infrastructure-apply.mp4" data-background="#000000">
      </section>

      <section>
        <h2><code>./app-infrastructure</code> (SaaS)</h2>
        <ul>
          <li class="fragment">RDS (Relational Database Service)</li>
          <li class="fragment">Route53 (DNS)</li>
          <li class="fragment">CloudWatch (monitoring, events, logging)</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>I app-infrastruktur-repoet har du oppsett av app-tjenester som er felles for de fleste appene.</li>
            <ul>
              <li>RDS</li>
              <li>DNS</li>
              <li>Monitorering, trigging av eventer og overvåkning.</li>
              <li>Streamer blant annet loggene fra CloudWatch til ElasticSearch.</li>
            </ul>
            <li>Felles for disse her er at du slipper å tenke på drift av de.</li>
            <li>Backup, speiling, patching, skalering osv. er håndtert av AWS</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>The right tool for the job?</h1>
        <img width="235" height="235" class="fragment" src="img/terraform.png" alt="Terraform">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes"> </aside>
      </section>

      <!-- Layout -->
      <section>
        <h2>Layout</h2>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
app-infrastructure
├── bin
│   └── get-aws-ids.sh
└── modules
    ├── database
    ├── route53_alias_record
    ├── route53_cname_record
    └── ssl_cert
     </code></pre>
        <aside class="notes"></aside>
      </section>

      <!-- DB -->
      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
resource "aws_db_instance" "db" {
  name                    = "${var.db_name}"
  identifier              = "${var.db_identifier}"
  engine                  = "${var.db_engine}"
  engine_version          = "${var.db_engine_version}"
  instance_class          = "${var.db_instance_class}"
  username                = "${var.db_username}"
  password                = "${var.db_password}"
  vpc_security_group_ids  = ["${aws_security_group.db_sg.id}"]
  db_subnet_group_name    = "${var.db_subnet_group_id}"
  parameter_group_name    = "${var.db_parameter_group_name}"
  backup_retention_period = "${var.backup_retention_period}"
  multi_az                = "${var.multi_az}"
  backup_window           = "${var.backup_window}"
  allocated_storage       = "${var.allocated_storage}"
}
     </code></pre>
        <aside class="notes">
          <ul>
            <li>Kan gjenbrukes på tvers av databaseplattformer.</li>
            <li>Vi gjør det. Har både MySQL og Postgres</li>
            <li>Amazon RDS manages backups, software patching, automatic failure detection, and recovery.</li>
            <li>Multi AZ: Standby i en annen availability zone</li>
          </ul>
        </aside>
      </section>

      <section>
        <img src="img/db.png" alt="Subnets">
        <aside class="notes">
          <ul>
            <li>DB</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>Dere skjønner poenget?</h1>
        <h2 class="fragment">Jeg skipper DNS og ssl-sertifikater...</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>AWS CLI</h1>
        <h2><code>get-aws-ids.sh</code></h2>
        <aside class="notes">
          <ul>
            <li>Som dere kanskje la merke til kjører jeg et skript for å hente metadata fra aws</li>
            <li>Bruker aws-cli</li>
          </ul>
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
#!/bin/bash

vpcid=$(aws ec2 describe-vpcs --filters "Name=tag-value, Values=${1}_vpc" | jq '.Vpcs[0].VpcId' | sed s/\"//g)
private_subnets=$(aws ec2 describe-subnets --filters "Name=vpc-id, Values=${vpcid}, Name=tag-value, Values=${1}_private_subnet*" | jq '.Subnets[].SubnetId' | tr '\n' ',' | sed s/,$//)
public_subnets=$(aws ec2 describe-subnets --filters "Name=vpc-id, Values=${vpcid}, Name=tag-value, Values=${1}_public_subnet*" | jq '.Subnets[].SubnetId' | tr '\n' ',' | sed s/,$//)
bastion_security_group_id=$(aws ec2 describe-security-groups --filters "Name=vpc-id, Values=${vpcid}, Name=tag-value, Values=${1}_bastion_ssh_sg*" | jq '.SecurityGroups[0].GroupId')
mgmtserver_security_group_id=$(aws ec2 describe-security-groups --filters "Name=vpc-id, Values=${vpcid}, Name=tag-value, Values=${1}_mgmtserver_sg*" | jq '.SecurityGroups[0].GroupId')
nat_ip=$(aws ec2 describe-nat-gateways --filter "Name=vpc-id, Values=${vpcid}" | jq ".NatGateways[0].NatGatewayAddresses[0].PublicIp")
route53_hosted_zone_id=$(aws route53 list-hosted-zones-by-name --dns-name ${2} | jq '.HostedZones[0].Id' | sed 's/\/hostedzone\///g')

     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section data-background-video="movie/terragrunt-app-infrastructure-plan-and-apply.mp4" data-background="#000000">
        <aside class="notes">
          <strong>NB! Video med både plan og apply!</strong>
        </aside>
      </section>

      <section>
        <h2><code>{./app1,./app2,...}</code> (PaaS)</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>From pets to cattle</h1>
        <p>&nbsp;</p>
        <img style="float: left; position: relative; display:inline-block;" width="300" src="img/luke_og_leia.png">
        <div style="display:inline-block;">
          <p style="float: none; position: relative; right: 30%;">&#8663;</p>
          <p style="float: none; position: relative; right: 30%;">&rArr;</p>
          <p style="float: none; position: relative; right: 30%;">&#8664;</p>
        </div>
        <img style="float: right; position: relative;" width="300" src="img/cattle.jpg">
        <footer class="layer right" style="font-size: 25px; position: relative; left: 37%; bottom: 10%; background-color: rgba(0, 0, 0, 0);">"When one of'em gets sick I just shoot'em in the head"</footer>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Elastic Beanstalk</h1>
        <img width="235" height="235" src="img/elastic-beanstalk.png" alt="Elastic Beanstalk">
        <aside class="notes">
          <ul>
            <li>Selve rosinen i pølsa</li>
            <li>Gjør alt det man kunne gjort i Terraform &rarr; Gjør det til PaaS</li>
          </ul>
        </aside>
      </section>


      <section>
        <h2>Elastic Beanstalk</h2>
        <blockquote>Easy to begin, Impossible to outgrow</blockquote>
        <ul class="fragment">
          <lh><strong>Automates and manages:</strong></lh>
          <div class="fragment">
            <li>configuration</li>
            <li>deploy</li>
            <li>capacity provisioning</li>
            <li>load balancing</li>
            <li>auto scaling</li>
            <li>monitoring</li>
          </div>
          <lf class="fragment">Without extra cost beyond the resources you use</lf>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
&lt;app1&gt;
├──.ebextensions
|  ├── 00-set-timezone.config
|  ├── 01-set-number-of-file-descriptors.config
|  ├── cw-logging.config
|  └── securelistener.config
├── Procfile
├── package.sh
├── create.sh
├── deploy.sh
├── terminate.sh
├── config
│   ├── nsbmob-servicelayer-&lt;env&gt;.properties
├── secretconfig
│   ├── nsbmob-servicelayer-&lt;env&gt;.properties.encrypted
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h5><code>.ebextensions/00-set-timezone.config</code></h5>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
commands:
  link_Oslo:
    command: "ln -sf /usr/share/zoneinfo/Europe/Oslo /etc/localtime"
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h5><code>.ebextensions/</code><br>
          <code>01-set-number-of-file-descriptors.config</code></h5>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
files:
  "/etc/security/limits.d/00-webapp.conf":
    content: |
      webapp           soft    nofile          65535
      webapp           hard    nofile          65535
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h5><code>.ebextensions/cw-logging.config</code></h5>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
option_settings:
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 7
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h5><code>.ebextensions/securelistener.config</code></h5>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
option_settings:
  aws:elb:listener:443:
    SSLCertificateId: arn:aws:acm:eu-central-1:635004941268:certificate/6502eb35-99a7-4004-8e47-a5a0ec194c6a
    ListenerProtocol: HTTPS
    InstancePort: 80
  aws:elb:listener:80:
    ListenerEnabled: false
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /nsbmob/health
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h5><code>Procfile</code></h5>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
web: java -jar app.jar
     </code></pre>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>3 kommandoer</h2>
        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
eb create
eb deploy
eb terminate
     </code></pre>
        <aside class="notes">
          Har laget wrappers. Hente ut metadata om hvilket vpc, hvilken db, subnett etc.
        </aside>
      </section>

      <section data-background-video="movie/eb-create.mp4" data-background="#000000">
      </section>

      <section data-background-video="movie/eb-deploy.mp4" data-background="#000000">
      </section>

      <section>
        <h1>Annet</h1>
        <ul>
          <li>Database Migration Service (DMS)</li>
          <li>Flyway</li>
        </ul>
        <aside class="notes">
          Verdt å nevne Flyway også
        </aside>
      </section>

      <section>
        <h1>Flyway</h1>
        <img width="235" height="235" src="img/flyway.png" alt="Flyway">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
          Snakke litt om Flyway
        </aside>
      </section>

      <section>
        <h2>The Expand/Contract pattern</h2>
        <br>
        <table class="reveal" width="100%">
          <th>Expand</th>
          <th>Contract</th>
          <tr>
            <td width="50%" class="fragment">
              <ul>
                <li>Add tables</li>
                <li>Add columns</li>
                <li>Tweak indexes</li>
              </ul>
            </td>
            <td width="50%" class="fragment">
              <ul>
                <li>Remove tables</li>
                <li>Remove columns</li>
                <li>Remove/add constraints</li>
              </ul>
            </td>
          </tr>
        </table>
      </section>
      <section>
        <img width="449" height="510" src="../img/architecture.png" alt="architecture">
      </section>
      <section>
        <img width="449" height="510" src="../img/pre-upgrade-db.png" alt="architecture">
      </section>
      <section>
        <img width="449" height="510" src="../img/upgrade1.png" alt="architecture">
      </section>
      <section>
        <img width="449" height="510" src="../img/upgrade2.png" alt="architecture">
      </section>
      <section>
        <img width="449" height="510" src="../img/post-upgrade-db.png" alt="architecture">
        <aside class="notes"> </aside>
      </section>
      <section>
        <img width="449" height="510" src="../img/architecture.png" alt="architecture">
      </section>

      <section>
        <h1>Oppsummert</h1>
        <aside class="notes">
          <ul>
            <li>Har snakket om veldig mye rart nå.</li>
            <li>Hvordan setter vi alt dette her sammen til et totalbilde?</li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>1 2 3 4 (5)</h1>
        <ol>
          <li class="fragment">IaaS med Terraform</li>
          <li class="fragment">PaaS-tjenester med Terraform (og litt Ansible)</li>
          <li class="fragment">Applikasjoner med Elastic Beanstalk (også PaaS)</li>
          <li class="fragment">DB migrering med Flyway</li>
          <li class="fragment">Monitorering med CloudWatch ++</li>
          <li class="fragment">(Masse tooling med Ansible)</li>
        </ol>
        <aside class="notes"> </aside>
      </section>


      <section>
        <h2><a href="http://www.visualops.io/">http://www.visualops.io/</a></h2>
        <aside class="notes"></aside>
      </section>

      <section>
        <img src="img/opstest-vpc.png" height="650">
        <aside class="notes"></aside>
      </section>

      <section>
        <h1>Planer for fremtiden</h1>
        <ul>
          <li class="fragment">Oppsplitting av backends &rarr; mikrotjenester</li>
          <li class="fragment">Alt i pass</li>
          <li class="fragment">Automatisere laging av OS images</li>
          <li class="fragment">#Serverless?</li>
        </ul>
        <aside class="notes">
          <ul>
            <li>Omnikanal, nsb.no og mobil backend</li>
            <li>Bruker ansible-vault ganske mye. Fører til duplisering av hemmeligheter</li>
            <li>
          </ul>
        </aside>
      </section>

      <section>
        <h1>Og ikke glem ...</h1>
        <aside class="notes">Destroy!</aside>
      </section>

      <section data-background-video="movie/destroy.mp4" data-background="#000000">
      </section>


      <section>
        <h1>&nbsp;</h1>
        <img width="570" src="img/devopsdays.png" alt="NSB">
        <p style="font-size: 28px;">&nbsp;</p>
        <p style="font-size: 28px;">&nbsp;</p>
        <aside class="notes">
        </aside>
      </section>


      <!--
      <section>
        <h2>Access control and audit</h2>
        <ul>
          <li>Keys</li>
          <li>2FA</li>
          <li>Rotation</li>
          <li>IAM
            <ul>
              <li>Users</li>
              <li>System users</li>
              <li>Services</li>
            </ul>
          </li>
        </ul>
        <aside class="notes">
        </aside>
      </section>


      <section>
        <h2>Network security</h2>
        <ul>
          <li>VPC</li>
          <li>Availability Zones</li>
          <li>Subnets</li>
          <li>Security groups</li>
          <li>EIP</li>
          <li>Bastion host</li>
          <li>Certificate manager</li>
          <li>Route 53</li>
          <li>Reverse proxy</li>
          <ul>
            <li>Redirects</li>
            <li>DNS Failover</li>
            <li>ELB</li>
          </ul>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Shared Responsibility Model</h2>
        <h3> (which security controls are the cloud vendor's responsibility, and which are yours)</h3>
        <ul>
          <li>Elastic Beanstalk</li>
          <li>RDS</li>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>Automating security</h1>
        <ul>
          <li>Terraform</li>
          <li>Ansible</li>
          <li>CLI</li>
          <li>bash</li>
        </ul>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Infrastructure as code using Terraform</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Configuration as code using Ansible</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Passwords, secrets and keys in an automated pipeline</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Managing individual credentials, VPN and 2FA</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Security logging and monitoring</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Security testing in a continuous delivery pipeline</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h1>In the end</h1>
        <aside class="notes">
          wrapping up
        </aside>
      </section>

      <section>
        <h2>Who's responsible?</h2>
        <aside class="notes">
        </aside>
      </section>

      <section>
        <h2>Why are you more secure in the cloud than in your own datacenter?</h2>
        <aside class="notes">
        </aside>
      </section>
-->

      <section data-background-video="../video/bedopress_animasjon_highress.mp4" data-background-video-loop="true" data-background="rgb(23, 22, 23)">
        <h2>Thank you!</h2>
        <p>Slides:<br><a href="http://steinim.github.io/slides/continuous-security-in-the-cloud/">http://steinim.github.io/slides/continuous-security-in-the-cloud/</a></p>
        <img width="252" height="235" src="../img/me_bart.png" alt="Stein Inge Morisbak">
        <p><a href="https://twitter.com/steinim">@steinim</a></p>
        <p><a href="mailto:stein.inge.morisbak@BEKK.no">stein.inge.morisbak@BEKK.no</a></p>
      </section>

    </div>
  </div>

  <script src="../lib/js/head.min.js"></script>
  <script src="../js/reveal.min.js"></script>

  <script>
    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
      controls: false,
      progress: true,
      history: true,
      center: true,
      width: 1100,

      theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
      transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

      // Optional libraries used to extend on reveal.js
      dependencies: [{
          src: '../lib/js/classList.js',
          condition: function() {
            return !document.body.classList;
          }
        },
        {
          src: '../plugin/markdown/marked.js',
          condition: function() {
            return !!document.querySelector('[data-markdown]');
          }
        },
        {
          src: '../plugin/markdown/markdown.js',
          condition: function() {
            return !!document.querySelector('[data-markdown]');
          }
        },
        {
          src: '../plugin/highlight/highlight.js',
          async: true,
          callback: function() {
            hljs.initHighlightingOnLoad();
          }
        },
        {
          src: '../plugin/zoom-js/zoom.js',
          async: true,
          condition: function() {
            return !!document.body.classList;
          }
        },
        {
          src: '../plugin/notes/notes.js',
          async: true,
          condition: function() {
            return !!document.body.classList;
          }
        }
        // { src: '../plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
        // { src: '../plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
      ]
    });

  </script>

</body>

</html>
